### Population Statistics

I now focus on service cuts in Poland, starting with the countryâ€™s overall population and primary school population. NUTS2 data is used, because Poland only provides data at this level. Each line represents a Polish NUTS2 region, of which there are 16. A plot's overall trend is displayed with a red trendline.

Contrary to my expectations, the overall population has not decreased in the past 20 years. However, the number of primary aged school children, aged seven to twelve, has decreased.

\pagebreak

**Polish Population in Millions by NUTS2**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_avg_population_change <- pl %>% 
  arrange(NUTS_ID, year) %>%
  group_by(NUTS_ID) %>%
  mutate(population_change = population - dplyr::lag(population),
         # Calculate the year-on-year percent increase. Multiplying by 100 gives the percent change.
         percent_change = (population_change / dplyr::lag(population)) * 100
         ) %>%
  summarise(
    avg_population_change = mean(population_change, na.rm = TRUE), # Average change in actual numbers
    avg_percent_change = mean(percent_change, na.rm = TRUE) # Average percent change
  )

pl %>% 
  left_join(pl_avg_population_change, by = "NUTS_ID") %>% 
  mutate(population = population / 1000000) %>% 
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>% 
  ggplot(aes(x = year, y = population)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in population (in %) ") +
  pl_plots_components
```

\pagebreak

**Polish Primary Age Population in Thousands by NUTS2**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_schools_avg_population_change <- pl_schools %>% 
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(population_change = population - dplyr::lag(population),
         percent_change = (population_change / dplyr::lag(population)) * 100) %>% # Calculate year-on-year increase
  summarise(avg_population_change = mean(population_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE)) # Calculate average increase

pl_schools %>% 
  left_join(pl_schools_avg_population_change, by = "NUTS_ID") %>% 
  mutate(population = population / 1000) %>% 
  mutate(avg_population_change = avg_population_change / 1000) %>% 
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>% 
  ggplot(aes(x = year, y = population)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in population (in 1000s) ") +
  pl_plots_components
```

\pagebreak

**Polish Emigration per 1000 Population by NUTS2**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_avg_emigration_change <- pl %>% 
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(emigration_change = emigration_yearly_per_1000 - dplyr::lag(emigration_yearly_per_1000),
         percent_change = (emigration_change / dplyr::lag(emigration_yearly_per_1000)) * 100) %>% 
  summarise(avg_emigration_change = mean(emigration_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE)) # Calculate average increase

pl %>% 
  left_join(pl_avg_emigration_change, by = "NUTS_ID") %>% 
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>% 
  ggplot(aes(x = year, y = emigration_yearly_per_1000)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in emigration ") +
  pl_plots_components
```

\pagebreak

### Number of Institutions

**Polish Schools by NUTS2**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_schools_avg_change <- pl_schools %>%
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(school_change = schools - dplyr::lag(schools),
         percent_change = (school_change / dplyr::lag(schools)) * 100) %>% 
  summarise(avg_school_change = mean(school_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE))

pl_schools %>% 
  left_join(pl_schools_avg_change, by = "NUTS_ID") %>%
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>%
  ggplot(aes(x = year, y = schools)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in number of schools ") +
  pl_plots_components
```

\pagebreak

**Polish Hospitals by NUTS2**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_hospitals_avg_change <- pl_hospitals %>%
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(hospital_change = hospitals - dplyr::lag(hospitals),
         percent_change = (hospital_change / dplyr::lag(hospitals)) * 100) %>% 
  summarise(avg_hospital_change = mean(hospital_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE))

pl_hospitals %>% 
  left_join(pl_hospitals_avg_change, by = "NUTS_ID") %>%
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>%
  ggplot(aes(x = year, y = hospitals)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "average of yearly change in number of hospitals ") +
  pl_plots_components
```
\pagebreak

**Polish Third Places by NUTS2**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_third_places_avg_change <- pl_third_places %>%
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(third_places_change = third_places - dplyr::lag(third_places),
         percent_change = (third_places_change / dplyr::lag(third_places)) * 100) %>% 
  summarise(avg_third_places_change = mean(third_places_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE))

pl_third_places %>% 
  left_join(pl_third_places_avg_change, by = "NUTS_ID") %>%
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>%
  ggplot(aes(x = year, y = third_places)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in number of third places ") +
  pl_plots_components +
  theme(legend.position = "bottom")
```


\pagebreak

### Ratios

Also contrary to my expectations, all services that I investigate generally see a decrease in their ratios. This means that over time, there are less people per institution in a NUTS2 region. E.g., less children in a school or less citizens per hospital.

\pagebreak

**Number of Polish Primary School Children per School by NUTS2**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_ratio_schools_avg_change <- pl_schools %>%
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(ratio_school_change = ratio_schools - dplyr::lag(ratio_schools),
         percent_change = (ratio_school_change / dplyr::lag(ratio_schools)) * 100) %>% 
  summarise(avg_ratio_school_change = mean(ratio_school_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE))

pl_schools %>% 
  left_join(pl_ratio_schools_avg_change, by = "NUTS_ID") %>%
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>%
  ggplot(aes(x = year, y = ratio_schools)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in children per school ") +
  pl_plots_components
```
\pagebreak

**Number of People per Hospital by NUTS2 in Poland**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_ratio_hospitals_avg_change <- pl_hospitals %>%
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(ratio_hospital_change = ratio_hospitals_all_population - dplyr::lag(ratio_hospitals_all_population),
         percent_change = (ratio_hospital_change / dplyr::lag(ratio_hospitals_all_population)) * 100) %>% 
  summarise(avg_ratio_hospital_change = mean(ratio_hospital_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE))

pl_hospitals %>% 
  left_join(pl_ratio_hospitals_avg_change, by = "NUTS_ID") %>%
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>%
  ggplot(aes(x = year, y = ratio_hospitals_all_population)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in people per hospital ") +
  pl_plots_components
```

\pagebreak

**Number of People per Third Place by NUTS2 in Poland**  
```{r echo=FALSE, fig.height = 8, message=FALSE, warning=FALSE}
pl_ratio_third_places_avg_change <- pl_third_places %>%
  arrange(NUTS_ID, year) %>% # Arrange data by region and then by year
  group_by(NUTS_ID) %>% # Group data by region
  mutate(ratio_third_places_change = ratio_third_places - dplyr::lag(ratio_third_places),
         percent_change = (ratio_third_places_change / dplyr::lag(ratio_third_places)) * 100) %>% 
  summarise(avg_ratio_third_places_change = mean(ratio_third_places_change, na.rm = TRUE),
            avg_percent_change = mean(percent_change, na.rm = TRUE))

pl_third_places %>% 
  left_join(pl_ratio_third_places_avg_change, by = "NUTS_ID") %>%
  mutate(NUTS_ID = reorder(NUTS_ID, -avg_percent_change)) %>%
  ggplot(aes(x = year, y = ratio_third_places)) +
  geom_smooth(aes(color = avg_percent_change), method = "loess", se = FALSE) +
  scale_color_gradient(name = "Average of yearly change in people per third place ") +
  pl_plots_components +
  theme(legend.position = "bottom")
```

\pagebreak

### Control Variables

Both remittances and GDP show an increase over time. I use these data as control variables in my models. Data on remittances are only available at the national level.

**Remittance Inflows (US$ million) for all of Poland**  
```{r echo=FALSE, fig.height=3, message=FALSE, warning=FALSE}
ggplot(pl_remittances, aes(x = year, y = remittances)) +
  geom_line(color = "light grey") +
  geom_smooth(aes(group = 1), method = "loess", color = "red", se = FALSE, size = 0.5) + 
  scale_y_continuous(labels = label_comma()) + ylab("") + xlab("") + theme_minimal()
```

**GDP at Current Market Prices in Poland by NUTS 2 (Euros per Inhabitant)**  
```{r echo=FALSE, fig.height=3, message=FALSE, warning=FALSE}
ggplot(pl_gdp, aes(x = year, y = gdp, line = NUTS_ID)) +
  geom_line(color = "light grey") +
  geom_smooth(aes(group = 1), method = "loess", color = "red", se = FALSE, size = 0.5) + 
  scale_y_continuous(labels = label_comma()) + ylab("") + xlab("") + theme_minimal()
```
