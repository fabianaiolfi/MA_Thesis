### Research Design
I explicitly differentiate between internal emigration, i.e., emigration within a country, and external emigration, i.e., emigration from one country to another. I do this because I aim to examine the impact of the EU’s FoM on voting behaviour in sending countries. I assume that the EU’s FoM makes emigration between member states easier. Based on this assumption, I focus on external emigration in order to best isolate the impact of FoM on voting behaviour.

Furthermore, I will measure external emigration and the effects of service cuts on the lowest subnational NUTS level that data are available for. Emigration rates vary across NUTS regions in Poland and Romania (see Figure \@ref(fig:pl-ro-emigration-rate)). Taking these regional differences into account will help develop accurate and robust models when examining the association between service cuts and incumbent support.

```{r pl-ro-emigration-rate, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Yearly Emigration Rate per 1000 Population"}

df <- cee_crude_emigration %>%
  dplyr::filter(country %in% c("RO", "PL")) %>% 
  dplyr::filter(year < 2020) %>% 
  mutate(country = case_when(country == "PL" ~ "Polish NUTS2 Regions",
                             country == "RO" ~ "Romanian NUTS3 Regions"))

ggplot(df, aes(x = year, y = emigration_yearly_per_1000, group = NUTS_ID)) +
  geom_line(color = "black") +
  geom_point(shape = 21, fill = "white", color = "black", size = 1) +
  facet_wrap(~ country,
             scales = "free_x",
             ncol = 2) +
  ylab(" ") +
  xlab(" ") +
  theme_minimal() +
  theme(
    panel.grid.minor = element_blank(),
    text = element_text(family = "serif"),
    strip.text = element_text(hjust = 0) # Left aligns the facet titles
  )
```

### Overview of Available Data
<!-- Overview of available data, how it was collected and transformed -->

<!-- Ideal Data Situation -->
I continue by describing which data would best help test my hypotheses.

In order to measure incumbent support, election results would ideally be available for each party within a NUTS3 region and for elections in the same time period that emigration data are available for. Furthermore, the data would ideally explicitly state if a party is in government, supports government or is in opposition. This makes it possible to differentiate between pro- and anti-incumbent support within a region.

Ideally, longitudinal data on the number of schools, hospitals and third places would be retrievable for every NUTS region under examination. This would allow to measure potential service cuts in a single region.

Ideal emigration data would also be longitudinal, beginning several years before a country’s accession and would continue up to and include the year 2019. Emigration rates for the year 2020 and later should be disregarded, as I assume the COVID-19 pandemic to interfere with international migration rates. Furthermore, the data would ideally be available for the lowest subnational region, i.e., NUTS3, and would explicitly differentiate between internal and external emigration. Finally, the data would be provided in the form of a rate per 1000 population, in order to make the data comparable across different NUTS3 regions.

However, the available data are not as extensive as prefered (see Table \@ref(tab:data-availability)). E.g., only NUTS2 level data is available for Poland across all variables. Also, for Poland and Romania @schraffEuropeanNUTSlevelElection2023 only include one election prior to their respective EU accession. This means that a party’s vote change can only be calculated for post-accession elections.

When constructing comparable models, data availability is limited by the dataset with the shortest historical reach. In this case, the primary constraint is the Polish electoral data and information on third places in Poland, both of which start in the year 2005. Therefore, to ensure comparability in my analysis, I am confined to using data from 2005 onwards. This limitation is necessary because only from this year do I have access to parallel data sets, allowing for a accurate comparison and analysis.

```{r data-availability, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="data_availability"}
data_availability <- data_availability %>% dplyr::rename(` ` = X)

kable(data_availability,
      caption = "Overview of Available Data; TO DO: Add sources",
      format = "latex",
      booktabs = TRUE
      )
  # kable_styling(font_size = 9) %>% 
  # add_footnote("Full party names can be looked up at partyfacts.herokuapp.com/data/partycodes/*Party ID*/", notation = "none")
```


<!-- Election Results Data -->
Subnational election results are provided by the European NUTS-level election dataset [@schraffEuropeanNUTSlevelElection2023]. I remove EU parliament elections from the data, leaving only national parliament election results. I also remove votes cast from abroad, parties with less than one percent of the national vote share (classified as “Other” [@schraffEuropeanNUTSlevelElection2023 571]) and elections before the year 1994 and after 2020. I calculate a party’s vote share by dividing the number of received votes by the total number of votes cast in the region, then multiply this by 100 to receive a party’s regional vote share in percent. In a next step, I calculate a party’s regional vote change between two consecutive elections.

Using unique party IDs, I can combine the V-Party Dataset [@staffan.i.lindbergetal.VPartyDatasetV22022] with the European NUTS-level election dataset. This combined dataset shows the regional vote change of incumbent parties. A random sample from this dataset is displayed in Table \@ref(tab:ned-vdem-sample) in order to provide an impression of the data structure.

<!-- Election Years -->
The years in which national parliamentary elections were held can be retrieved from the European NUTS-level election dataset. I manually add election years in order for the dataset to align with the emigration data. These missing years are retrieved from Wikipedia.^[E.g., https://en.wikipedia.org/wiki/2019_Polish_parliamentary_election or https://en.wikipedia.org/wiki/2016_Romanian_parliamentary_election (both retrieved 15 January 2024)]

<!-- Incumbent Party Data -->
\label{passage:incumbent-party} The V-Party Dataset provides information on which parties are in or support the government.^[Variable *v2pagovsup*: “Does this party support the government formed immediately after this election?” I categorise the responses “Yes, as senior partner”, “Yes, as junior partner” and “Yes, but the party is not officially represented in government” as an incumbent party [@vpartyCodebook, 24]] I manually add further elections and parties to the data^[See https://github.com/fabianaiolfi/MA_Thesis/blob/main/scripts/01_anti_incumbent_vote/02_1_manual_adjustment.R for details] in order to match it to the emigration data time span and to minimise the number of missing values. Data on whether a party is incumbent or in opposition is based on the party’s documented electoral history on their respective Wikipedia page.^[E.g., https://en.wikipedia.org/wiki/Greater_Romania_Party#Electoral_history (retrieved 15 January 2024)] This manual extension results in a more complete picture of anti-incumbent voting. However, I only manually add missing values of parties with a vote share equal to or larger than 4\% and a vote change between elections equal to or larger than 1\%. I do this in order to keep the scope of this thesis manageable. I categorise parties that show government support leading up to an election as incumbent, even if they are outside of government. I do this because the V-Party Dataset defines incumbents the same way and I make the assumption that a voter who wants to cast a ballot *against* the incumbent will vote against any party that supports or sympathises with incumbent parties.

<!-- Service Cuts -->
Data on service cuts at regional levels are provided by national statistical offices. <!-- Service Cuts in Poland --> The Polish government agency Statistics Poland^[https://bdl.stat.gov.pl/bdl/start, retrieved 20 November 2023] provides data on the number of primary schools at NUTS2 level^[Variable *P1781*: Primary schools for children, youth, and adults, by governing authority (https://bdl.stat.gov.pl/bdl/dane/podgrup/tablica, retrieved 20 November 2023)] and the size of the primary school population.^[Variable *P1341*: Population by singular age and sex (https://bdl.stat.gov.pl/bdl/dane/podgrup/tablica, retrieved 20 November 2023)]. Statistics Poland also provides NUTS2 level data on the number of hospitals^[Variable *P2452*: General hospitals (https://bdl.stat.gov.pl/bdl/dane/podgrup/tablica, retrieved 24 November 2023)] as well as the number of third places. ^[Variable *P2505*: Number of catering estabilishments [sic] (https://bdl.stat.gov.pl/bdl/dane/podgrup/tablica, retrieved 27 November 2023)]

<!-- Service Cuts in Romania -->
The Romanian government agency National Institute of Statistics^[https://insse.ro/cms/en, retrieved 15 January 2024] hosts data on the number of primary and lower-secondary schools^[Variable *SCL101A*: Education units, by categories of units, ownerships, macroregions, development regions and counties (http://statistici.insse.ro:8077/tempo-online/#/pages/tables/insse-table, retrieved 15 December 2023)] and the size of the population enrolled in these schools.^[Variable *SCL103E*: Enrolled population, by level of education, urban/ rural area, macroregions, development regions and counties (http://statistici.insse.ro:8077/tempo-online/#/pages/tables/insse-table, retrieved 15 December 2023)] Furthermore, Romania’s National Institute of Statistics also counts the number of hospitals^[Variable *SCL101A*: Sanitary units, by category of units, ownerships, macroregions, development regions and counties (http://statistici.insse.ro:8077/tempo-online/#/pages/tables/insse-table, retrieved 18 December 2023)] and third places.^[Variable *INT101U*: Active local units, by activity of national economy at level of CANE Rev.2 classes, size classes of number of employees, macroregions, development regions and counties (http://statistici.insse.ro:8077/tempo-online/#/pages/tables/insse-table, retrieved 15 December 2023)]

<!-- Romanian Classrooms as a proxy -->
As Figure \@ref(fig:ro-schools) in the Appendix shows, \label{passage:ro-school-drop} there is a large drop in the number of Romanian schools in the early 2000s. I suspect that along with school closures, the Romanian National Institute of Statistics changed the way they counted single school entities.^[The Romanian National Institute of Statistics define an “education unit” as an entity under a “single management system” (Source: http://statistici.insse.ro:8077/tempo-online/#/pages/tables/insse-table, retrieved 29 January 2024). This obscure definition could indicate that the number of school buildings can also change depending on how schools are managed within a region.] To counter this problem, I use the number of classrooms in primary and lower-secondary schools^[Variable *SCL105C*: Classrooms (school cabinets/amphiteaters [sic]), by level of education, macroregions, development regions and counties (http://statistici.insse.ro:8077/tempo-online/#/pages/tables/insse-table, retrieved 8 January 2024)] as a proxy for the number of school buildings. Figure \@ref(fig:ro-classrooms) in the Appendix displays the number of classrooms, whereby a decrease is visible across most regions, but no sudden drop occurs. Thus I assume the number of classrooms to be an adequate proxy for the number of Romanian school buildings.

<!-- External emigration for all CEE -->
Data on external emigration are provided by Statistics Poland and the Romanian National Institute of Statistics. I define external emigration as the sum of people moving abroad from a NUTS region in a single year. I pick this absolute value because it carries more validity when it comes to measuring the impact of emigration than, e.g., net migration, a popular metric when measuring migration. Net migration has the disadvantage of including *immigration* in its calculation, thus not fully revealing the number of people emigrating from a region.

<!-- Data Wrangling -->
Statistics Poland provide their data in the form of comma separated values (.CSV) files, while the Romanian National Institute of Statistics offer their data as Microsoft Excel (.XLS) files. I extract the data from all files using the R programming language. Data from all sources described above can then be easily combined based on all the source’s common use of NUTS region names.

```{r ned-vdem-sample, echo=FALSE, message=FALSE, warning=FALSE, results='asis', fig.cap="Show snippet of n_v_dem_cee"}
df <- ned_v_dem_cee %>%
  drop_na(prev_incumbent) %>% 
  mutate(vote_share = round(vote_share, 2)) %>% 
  mutate(vote_change = round(vote_change, 2)) %>% 
  mutate(vote_change_sign = case_when(vote_change > 0 ~ "+",
                                      T ~ "")) %>%
  dplyr::select(year, country, regionname, nuts2016, unique_party_id, vote_share, vote_change_sign, vote_change, prev_incumbent) %>%
  mutate(vote_change = paste0(vote_change_sign, vote_change)) %>% 
  mutate(vote_change = gsub("-", "–", vote_change)) %>% 
  dplyr::rename(Year = year,
                Country = country,
                `Region Name` = regionname,
                `NUTS ID` = nuts2016,
                `Party ID` = unique_party_id,
                `Vote Share %` = vote_share,
                `Vote Change` = vote_change,
                `Incumbent?` = prev_incumbent,
                ) %>% 
  dplyr::select(-vote_change_sign) %>% 
  sample_n(10) %>% 
  arrange(Year)

kable(df,
      caption = "Random Selection of Rows from the Combined European NUTS-Level Election Dataset and the V-Party Dataset",
      format = "latex",
      booktabs = TRUE
      ) %>%
  kable_styling(font_size = 9) %>% 
  add_footnote("Full party names can be looked up at partyfacts.herokuapp.com/data/partycodes/*Party ID*/", notation = "none")
```
