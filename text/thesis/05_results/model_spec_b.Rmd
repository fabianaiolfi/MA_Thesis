
```{r echo=FALSE, message=FALSE, warning=FALSE}
# With control variables
# Using average ratio between elections
fe_lm_0 <- feols(vote_change ~
                   emigration_election_year_per_1000 +
                   volatility + gdp + unemployment |
                   nuts2016 + year,
                 data = anti_incumbent_vote)
#this is the one
fe_lm_1 <- feols(vote_change ~
                   average_ratio_schools_election_year *
                   emigration_election_year_per_1000 +
                   volatility + gdp + unemployment |
                   nuts2016 + year,
                 data = anti_incumbent_vote)

fe_lm_2 <- feols(vote_change ~
                   average_ratio_classrooms_election_year *
                   emigration_election_year_per_1000 +
                   volatility + gdp + unemployment |
                   nuts2016 + year,
                 data = anti_incumbent_vote)

fe_lm_3 <- feols(vote_change ~
                   average_ratio_hospitals_election_year *
                   emigration_election_year_per_1000 +
                   volatility + gdp + unemployment |
                   nuts2016 + year,
                 data = anti_incumbent_vote)

fe_lm_4 <- feols(vote_change ~
                   average_ratio_third_places_election_year *
                   emigration_election_year_per_1000 +
                   volatility + gdp + unemployment |
                   nuts2016 + year,
                 data = anti_incumbent_vote)

fe_lm_5 <- feols(vote_change ~
                   average_ratio_schools_election_year *
                   emigration_election_year_per_1000 +
                   
                   average_ratio_hospitals_election_year *
                   emigration_election_year_per_1000 +

                   average_ratio_third_places_election_year *
                   emigration_election_year_per_1000 +
                   
                   volatility + gdp + unemployment |
                   nuts2016 + year,
                 data = anti_incumbent_vote)

fe_lm_6 <- feols(vote_change ~
                   average_ratio_classrooms_election_year *
                   emigration_election_year_per_1000 +
                   
                   average_ratio_hospitals_election_year *
                   emigration_election_year_per_1000 +
                   
                   average_ratio_third_places_election_year *
                   emigration_election_year_per_1000 +
                   
                   volatility + gdp + unemployment |
                   nuts2016 + year,
                 data = anti_incumbent_vote)
```

```{r results-emigration-incumbent-vote-share-control-interaction, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Emigration interacted with Service Cuts on Incumbent Vote Share with Control Variables; DV: Change in Incumbent Vote Share; Model Specification B"}
# new_names <- c(
#   "average_ratio_classrooms_election_year:emigration_election_year_per_1000" = "Classrooms-Emigration Interaction",
#   "emigration_election_year_per_1000:average_ratio_hospitals_election_year" = "Hospitals-Emigration Interaction",
#   "emigration_election_year_per_1000:average_ratio_third_places_election_year" = "Third Places-Emigration Interaction",
#   "volatility" = "Economic Volatility",
#   "gdp" = "Gross Domestic Product",
#   "unemployment" = "Unemployment Rate"
# )
# 
# modelsummary(fe_lm_6, coef_map = new_names)

model_table <- modelsummary(list("Model 0" = fe_lm_0,
                                 "Model 1" = fe_lm_1,
                                 "Model 2" = fe_lm_2,
                                 "Model 3" = fe_lm_3,
                                 "Model 4" = fe_lm_4,
                                 "Model 5" = fe_lm_5,
                                 "Model 6" = fe_lm_6),
              title = "Emigration interacted with Service Cuts on Incumbent Vote Share with Control Variables; DV: Change in Incumbent Vote Share; Model Specification B",
             coef_map = c("average_ratio_schools_election_year:emigration_election_year_per_1000" = "Avg. Children per School × Emigration since last election",
                          "average_ratio_classrooms_election_year:emigration_election_year_per_1000" = "Avg. Children per Classroom × Emigration since last election",
                          "emigration_election_year_per_1000:average_ratio_hospitals_election_year" = "Avg. People per Hospital × Emigration since last election",
                          "average_ratio_hospitals_election_year:emigration_election_year_per_1000" = "Avg. People per Hospital × Emigration since last election",
                          "emigration_election_year_per_1000:average_ratio_third_places_election_year" = "Avg. People per Third Place × Emigration since last election",
                          "average_ratio_third_places_election_year:emigration_election_year_per_1000" = "Avg. People per Third Place × Emigration since last election",
                          "emigration_election_year_per_1000" = "Emigration since last election",
                          "volatility" = "Volatility",
                          "gdp" = "GDP per capita",
                          "unemployment" = "Unemployment"),
             gof_omit = "AIC|BIC|RMSE|Std.Errors|FE",
             statistic = "p.value",
             stars = T,
             notes = "Fixed Effects: NUTS regions and years. Standard errors are grouped by NUTS3 region. p-values shown in parentheses.")

model_table %>%
  kable_styling(font_size = 7)
```

<!-- description of model specification B results -->
- Table \@ref(tab:results-emigration-incumbent-vote-share-control-interaction) displays the results of modelling the interaction between average change of number of people per institution on incumbent support, while controlling for emigration, volatility, GDP und unemployment and applying NUTS3 region and year fixed effects; This is the implementation of Model Specification B.
- The results from these models tell us what the effect of a service cut is, given a specific emigration rate
- The models in Table \@ref(tab:results-emigration-incumbent-vote-share-control-interaction) also include coefficients for service cuts on their own, in order to measure the direct effect of service cuts on incumbent vote share change. However, they have been removed from the table to keep it tidy and because the focus is on the interaction terms and the interpretation of the service cut coefficients by themselves are not meaningful.
- Model 0 does not include any service cuts variables and is included in Table \@ref(tab:results-emigration-incumbent-vote-share-control-interaction) as a reference model

- As in Table \@ref(tab:results-emigration-incumbent-vote-share), the service cuts when interacted with emigration display mixed results. 
- When modelling service cuts conditioned on emigration seperately on incumbent vote share change, only service cuts to schools (Model 1 operationalised using school buildings) displays a coefficient that aligns with the theoretical expectations, i.e., a negative coefficient, and is (borderline) statistically significant at $p = 0.112$.
- This statistically significant term hints that the effect of service cuts on incumbent vote share change differes between different values of emigration
- The only other coefficient to meet the theoretical expectations is that of hospital service cuts when interacted with emigration (Model 3). However, this coefficient is not statistically significant at conventional levels ($p = 0.200$) and the coefficient’s size at $-0.001$ is very small.

<!-- Interpreting interaction terms https://theeffectbook.net/ch-StatisticalAdjustment.html#interaction-terms -->
- What does Model 1’s negative interaction coefficient mean? We take a closer look
- The base effect of school service cuts on incumbnet vote share change, without taking the emigration into account, equals $0.045$ (not shown in Table \@ref(tab:results-emigration-incumbent-vote-share-control-interaction)). This means that for an increase of one child per school, incumbent vote chare change increases by $0.045\%$, holding all other variables constant
- The interaction term modifies this effect based on the emigration rate. For each one-unit increase in emigration, the effect of school service cuts on incumbent vote share change decreases by $0.058\%$
- In order to calculate the total effect of a one child per school increase when emigration also increases by one person per 1000, I sum the base effect of service cuts and the interaction effect: $0.045 - 0.058 = -0.013$.
- This means that when emigration increases by one person per 1000, the effect of school service cuts on incumbent vote share change shifts from a positive effect of $0.045\%$ to a negative effect of $0.013\%$.
- In other words, in NUTS3 regions where the emigration rate is higher by one unit, an increase in children per school is associated with a decrease in incumbent vote share change, rather than an increase.

- In sum, “the negative effect of service cuts on the change in incumbent vote share becomes more pronounced as the emigration rate increases. In other words, in Romanian NUTS3 regions with higher emigration rates, the impact of less schools on reducing incumbent vote share is stronger."


```
- we can interpret this coefficient to mean that while controlling for emigration, electoral volatility, GDP per capita and unemployment, for a given Romanian NUTS3 region, in a year where the average rate of children per school is one child higher that it typically is for that region, we would expect the incumbent vote share to decrease by $0.093\%$ more than is typical for that region.
- The coefficient value can also be reformulated so: If a school grows by eleven children, then this is associated with an incumbent vote share decrease of around $1\%$, taking the above mentioned caveats into account.
```

```
- The change in number of hospitals has no effect, and the change in number of third places shows a positive effect. This indicates that an increase in the number of third places is associated with an increase in incumbent vote share
- The results in Models 3 and 4 are not statistically significant at conventional levels.
- Models 5 and 6 combine all service cuts together, with Model 5 using the number of schools and Model 6 using the classroom proxy
- The results from Models 5 and 6 are not much different to the Models 1 through 4. Again, only school service cuts show negative associations, but these results are not statistically significant
```

<!-- R2 values; https://stats.stackexchange.com/a/401331 -->
```
- One difference between the variable combining Models 5 and 6 with Models 1 through 4 are the increased Adjusted Within R-Squared values.
- We can interpret the Adjusted Within R-Squared as the variation in incumbent vote share change within Romanian NUTS3 regions over time caputed by a model. E.g., Model 5 displays the highest such value, with $28.6\%$ of the variation being explained by the model.
- This indicates that combining all service cuts as independent variables makes the models fit the data better than using the service cuts by themselves. This increase in within groups explanatory power hints at the possibility that all these different service cuts contribute to influencing incumbent support through voting.
```


<!-- control variable coefficient results: do control variables align with theoretical expectations? -->
```
- I move on to report on the control variable coefficient results. I aknowledge that control variables are not in the primary interest, however they can contribute to evidence of effects on incumbent vote support [@hunermundNuisanceControlVariables2023 4]
- Three of the four control variables display coefficients that align with the theoretical assumptions and are statistically significant across all models. 
- We can observe that an increase in emigration is associated with a decrease in incumbent vote share. This fits into the causal mechanism of emigration causing grievances, which in turn decreases incumbent support
- Both economic variables, GDP per capital and unemployment, show coefficients that align with theoretical expectations. An increase in per capita GDP is associated with an increase in incumbent support, which can be interpreted that incumbent parties are rewarded for a good state of the economy. On the other hand, we see that an increase in unemployment is associated with a decrease in incumbent support. This suggests that voters punish incumbent parties for poor economic performance
- The Volatility coefficient shows a positive coefficient throughout all models, indicating an increase in volatility is associated with an increase in incumbent support. This does not make intuitive sense, as we would expect high levels of volatility to be associated with a decrease in incumbent support, as incumbent parties would be voted out of office more often than not.
```

<!-- emigration change in coefficient strength over models: omitted variable bias -->
```
- I move on to discuss varying coefficient strength of the control variable emigration.
- Depending which service cut is added to the model, the coefficient varies in strength. 
- This hints at omitted variable bias in Model 0.
- We observe the biggest change in strength when school service cuts are added using the children per school operationalisation (Model 1). Here the emigration coefficient increases by $0.339$, from $-5.5$ to $-5.161$. This indicates that Model 0 was underspecified and suffered from omittied variables bias, whereby the effect of emigration on incumbent support is overstated. This is then corrected when school service cuts are added to the model.
- Same goes for Models 2, 4 and 6, as these models also see a decrease in coefficient size, however in smaller amounts compared to Model 1.
```

- TO DO: discuss implications of interaction term
- TO DO: different interpretation of results when one service cuts and several service cuts!


